---
import { getLatestPosts } from "@/lib/blog";
import { getHeroLatestPosts } from "@/lib/hero";

import ApplyStep from "@/components/home/ApplyStep.astro";
import Event from "@/components/home/Event";
import Hero from "@/components/home/Hero";
import Partnership from "@/components/home/Partnership.astro";

import { languages } from "@/i18n/ui";
import { getLangFromUrl } from "@/i18n/utils";
import Layout from "@/layouts/Layout.astro";

export async function getStaticPaths() {
  return Object.keys(languages).map((lang) => ({
    params: { lang },
  }));
}

const lang = getLangFromUrl(Astro.url);
const latestPosts = await getLatestPosts(lang);
const heroPosts = await getHeroLatestPosts(lang);
---

<Layout
  title="ទំព័រដើម - Home"
  description="DSDP Cambodia - Digital Service Delivery Platform"
  author="DSDP Cambodia"
>
  <Hero lang={lang} latestPosts={heroPosts} client:load />
  <ApplyStep lang={lang} />
  <Event lang={lang} latestPosts={latestPosts} client:load />
  <Partnership lang={lang} />
</Layout>
