---
import { getLatestPosts, getRemainingBlogPosts } from "@/lib/blog";

import { BlogList } from "@/components/pages/newsAndEvents/BlogList";
import LatestBlogList from "@/components/pages/newsAndEvents/LatestBlogList.astro";

import background_svg_blob from "@/assets/about/about-us/background-svg-blob.svg";
import { languages, ui } from "@/i18n/ui";
import { getLangFromUrl } from "@/i18n/utils";
import Layout from "@/layouts/layout.astro";
import { Image } from "astro:assets";

export async function getStaticPaths() {
  return Object.keys(languages).map((lang) => ({
    params: { lang },
  }));
}

const lang = getLangFromUrl(Astro.url);
const translations = ui[lang];
const latestPosts = await getLatestPosts(lang);
const remainingPosts = await getRemainingBlogPosts(lang);
---

<Layout title={`អត្ថបទព័ត៌មាន និង ព្រឹត្តិការណ៍ - News and Events`}>
  <!-- Background decorations -->
  <section class="relative left-1/2 -translate-x-1/2 overflow-hidden">
    <div class="absolute inset-0 -z-10 pointer-events-none">
      <Image
        src={background_svg_blob}
        alt="bottom background"
        class="absolute bottom-[10%] left-[50%] w-full max-w-full h-auto rotate-[270deg] -scale-x-[1] opacity-50"
      />
    </div>
    <LatestBlogList
      translations={translations}
      posts={latestPosts}
      lang={lang}
    />
    <BlogList
      translations={translations}
      posts={remainingPosts}
      lang={lang}
      client:load
    />
  </section>
</Layout>
