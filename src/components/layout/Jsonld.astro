---
type AuthorProps = {
  name: string;
  url?: URL;
};

export type URLType = URL | string | undefined;
type jsondlType = "WebPage" | "BlogPosting";

interface Props {
  title: string;
  description?: string;
  siteUrl: URLType;
  canonicalUrl: URLType;
  defaultSiteProjectName: string;
  image: URLType;
  type: jsondlType;
  author: AuthorProps;
}

const {
  title,
  description,
  siteUrl,
  canonicalUrl,
  defaultSiteProjectName,
  type,
  image = "/logo.png",
  author,
} = Astro.props;
---

<script
  type="application/ld+json"
  set:html={JSON.stringify(
    {
      "@context": "https://schema.org",
      "@type": type,
      headline: title,
      description: description ?? "",
      image: new URL(image, siteUrl).toString(),
      author: {
        "@type": "Person",
        name: author.name,
        url: author.url,
      },
      publisher: {
        "@type": "Organization",
        name: defaultSiteProjectName,
        logo: {
          "@type": "ImageObject",
          url: new URL("/favicon.svg", siteUrl).toString(),
        },
      },
      datePublished: new Date().toISOString(),
      dateModified: new Date().toISOString(),
      mainEntityOfPage: {
        "@type": type,
        "@id": canonicalUrl,
      },
    },
    null,
    2,
  ).replace(/</g, "\u003c")}
/>
